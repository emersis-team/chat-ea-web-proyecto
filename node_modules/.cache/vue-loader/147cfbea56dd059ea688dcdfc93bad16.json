{"remainingRequest":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\src\\components\\Chat.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\src\\components\\Chat.vue","mtime":1593709727781},{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Trabajos\\CIDESO\\chat-ea-web\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbWVuc2FqZXM6IFtdLAogICAgICB1c2VySWQ6IG51bGwKICAgIH07CiAgfSwKICBwcm9wczogeyBjb252ZXJzYWNpb246IFtPYmplY3RdIH0sCiAgY29tcHV0ZWQ6IHt9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLnVzZXJJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCIkdXNlcklkIik7CiAgICB0aGlzLmdldENoYXQoKTsKICAgIHRoaXMuYWN0dWFsaXphcigpOwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJGV2ZW50SHViLiRvbigiY2hhdC1nZXQiLCBpZCA9PiB0aGlzLmdldENoYXQoaWQpKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGFjdHVhbGl6YXIoKSB7CiAgICAgIHZhciB0aGF0ID0gdGhpczsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICB0aGF0LmdldENoYXQoKTsKICAgICAgICB0aGF0LmFjdHVhbGl6YXIoKTsKICAgICAgfSwgMzAwMCk7CiAgICB9LAogICAgZ2V0Q2hhdChpZCkgewogICAgICBpZiAoaWQgPT0gbnVsbCkgewogICAgICAgIGlkID0gdGhpcy5jb252ZXJzYWNpb24uaWQ7CiAgICAgIH0KICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGlzLm1lbnNhamVzID0gW107CiAgICAgIHRoaXMuJGF4aW9zCiAgICAgICAgLmdldCh0aGlzLiRsb2NhbHVybCArICIvYXBpL3YxL21lc3NhZ2VzLyIgKyBpZCkKICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgdGhhdC5tZW5zYWplcyA9IHJlc3BvbnNlLmRhdGEubWVzc2FnZXMuZGF0YTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChmdW5jdGlvbigpIHsKICAgICAgICAgIHRoYXQuZXJyb3JVc3VhcmlvID0gdHJ1ZTsKICAgICAgICAgIHRoYXQuZXJyb3JQYXNzd29yZCA9IHRydWU7CiAgICAgICAgfSk7CiAgICB9LAogICAgZW52aWFyKCkgewogICAgICB2YXIgdGV4dG8gPSB0aGlzLiRyZWZzLmlucHV0VGV4dG8udmFsdWU7CiAgICAgIGlmICh0ZXh0byAhPSAiIikgewogICAgICAgIHRoaXMubWVuc2FqZXMucHVzaCh7CiAgICAgICAgICBpZDogMCwKICAgICAgICAgIHNlbmRlcl9pZDogdGhpcy51c2VySWQsCiAgICAgICAgICBtZXNzYWdlOiB0ZXh0bwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJlZnMuaW5wdXRUZXh0by52YWx1ZSA9ICIiOwogICAgICAgIHZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZGF0YS5hcHBlbmQoIm1lc3NhZ2UiLCB0ZXh0byk7CiAgICAgICAgZGF0YS5hcHBlbmQoInJlY2VpdmVyX2lkIiwgdGhpcy5jb252ZXJzYWNpb24udXNlcl9kZXN0LmlkKTsKICAgICAgICB0aGlzLiRheGlvcwogICAgICAgICAgLnBvc3QodGhpcy4kbG9jYWx1cmwgKyAiL2FwaS92MS9tZXNzYWdlcy8iLCBkYXRhKQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7fSkKICAgICAgICAgIC5jYXRjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgYWxlcnQoIlNlIHByb2R1am8gdW4gZXJyb3IsIHJlaW50ZW50ZSIpOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Chat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Chat.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"chat\">\n    <div>\n      <div\n        v-for=\"mensaje in mensajes\"\n        :key=\"mensaje.id\"\n        class=\"chat-container\"\n        v-bind:class=\"{ 'chat-mensaje-propio': mensaje.sender_id == userId }\"\n      >\n        <div class=\"chat-mensaje\">\n          <label>{{ mensaje.message }}</label>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"chat-bottom\">\n      <input type=\"text\" placeholder=\"Escribe un mensaje aquÃ­\" ref=\"inputTexto\" />\n      <button @click=\"enviar()\">Enviar</button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      mensajes: [],\n      userId: null\n    };\n  },\n  props: { conversacion: [Object] },\n  computed: {},\n  mounted() {\n    this.userId = localStorage.getItem(\"$userId\");\n    this.getChat();\n    this.actualizar();\n  },\n  created() {\n    this.$eventHub.$on(\"chat-get\", id => this.getChat(id));\n  },\n  methods: {\n    actualizar() {\n      var that = this;\n      setTimeout(function() {\n        that.getChat();\n        that.actualizar();\n      }, 3000);\n    },\n    getChat(id) {\n      if (id == null) {\n        id = this.conversacion.id;\n      }\n      var that = this;\n      this.mensajes = [];\n      this.$axios\n        .get(this.$localurl + \"/api/v1/messages/\" + id)\n        .then(function(response) {\n          that.mensajes = response.data.messages.data;\n        })\n        .catch(function() {\n          that.errorUsuario = true;\n          that.errorPassword = true;\n        });\n    },\n    enviar() {\n      var texto = this.$refs.inputTexto.value;\n      if (texto != \"\") {\n        this.mensajes.push({\n          id: 0,\n          sender_id: this.userId,\n          message: texto\n        });\n        this.$refs.inputTexto.value = \"\";\n        var data = new FormData();\n        data.append(\"message\", texto);\n        data.append(\"receiver_id\", this.conversacion.user_dest.id);\n        this.$axios\n          .post(this.$localurl + \"/api/v1/messages/\", data)\n          .then(function() {})\n          .catch(function() {\n            alert(\"Se produjo un error, reintente\");\n          });\n      }\n    }\n  }\n};\n</script>\n\n<style scoped src=\"../assets/css/components/chat.css\"></style>\n"]}]}