{"map":{"version":3,"sources":["js/chat.ffbf9682.js"],"names":["window","push","293a","module","__webpack_exports__","__webpack_require__","r","render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","id","on","scroll","onScroll","_l","mensaje","key","class","chat-mensaje-propio","sender_id","userId","_v","_s","message","type","placeholder","keyup","$event","indexOf","_k","keyCode","enviar","click","staticRenderFns","Chatvue_type_script_lang_js_","data","mensajes","primeraPagina","currentPage","lastPage","mensajeOffset","props","computed","mounted","localStorage","getItem","getChat","actualizar","$refs","chatScroll","addEventListener","created","_this","$eventHub","$on","methods","that","setTimeout","$route","params","$axios","get","$localurl","then","response","isOverflown","document","getElementById","getChatPage","scrollear","messages","last_page","reverse","forEach","m","some","conversation_id","length","scrollToBottom","catch","status","$router","pagina","pag","concat","target","scrollTop","clientHeight","offset","limit","$nextTick","offsetTop","texto","inputTexto","value","FormData","append","user_dest_id","post","alert","element","scrollHeight","scrollWidth","clientWidth","views_Chatvue_type_script_lang_js_","componentNormalizer","component","Object","3bae","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_home_css_vue_type_style_index_1_id_52ed952f_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_home_css_vue_type_style_index_1_id_52ed952f_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n","6514","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_chat_css_vue_type_style_index_0_id_52ed952f_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_chat_css_vue_type_style_index_0_id_52ed952f_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default","8e3c","exports","a339"],"mappings":"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"},"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chat\"],{\"293a\":function(t,e,s){\"use strict\";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"home\"},[s(\"div\",{staticClass:\"home-body\"},[s(\"div\",{staticClass:\"home-right\"},[s(\"div\",{staticClass:\"chat\"},[s(\"div\",{ref:\"chatScroll\",staticClass:\"chat-scroll\",attrs:{id:\"chatScroll\"},on:{scroll:t.onScroll}},t._l(t.mensajes,(function(e){return s(\"div\",{key:e.id,staticClass:\"chat-container\",class:{\"chat-mensaje-propio\":e.sender_id==t.userId},attrs:{id:e.id}},[s(\"div\",{staticClass:\"chat-mensaje\"},[s(\"label\",[t._v(t._s(e.message))])])])})),0),s(\"div\",{staticClass:\"chat-bottom\"},[s(\"input\",{ref:\"inputTexto\",attrs:{type:\"text\",placeholder:\"Escribe un mensaje aqu√≠\"},on:{keyup:function(e){return!e.type.indexOf(\"key\")&&t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?null:t.enviar()}}}),s(\"button\",{staticClass:\"chat-enviar\",on:{click:function(e){return t.enviar()}}},[t._v(\"Enviar\")])])])])])])},n=[],i=(s(\"99af\"),s(\"4160\"),s(\"45fc\"),s(\"159b\"),{data:function(){return{mensajes:[],userId:null,primeraPagina:!0,currentPage:0,lastPage:0,mensajeOffset:null}},props:{},computed:{},mounted:function(){this.userId=localStorage.getItem(\"$userId\"),this.getChat(),this.actualizar(),this.mensajes=[],this.$refs.chatScroll.addEventListener(\"touchmove\",this.onScroll)},created:function(){var t=this;this.$eventHub.$on(\"chat-get\",(function(e){return t.getChat(e)}))},methods:{actualizar:function(){var t=this;setTimeout((function(){t.getChat(),t.actualizar()}),3e3)},getChat:function(t){null==t?t=this.$route.params.id:(this.mensajes=[],this.primeraPagina=!0);var e=this;this.$axios.get(this.$localurl+\"/api/v1/messages/\"+t).then((function(t){1!=e.primeraPagina||e.isOverflown(document.getElementById(\"chatScroll\"))||(e.primeraPagina=!1,e.getChatPage(2));var s=!1;e.lastPage=t.data.messages.last_page,t.data.messages.data.reverse(),t.data.messages.data.forEach((function(t){e.mensajes.some((function(e){return e.id==t.id}))||t.conversation_id!=e.$route.params.id||(e.mensajes.push(t),s=!0)})),1==s&&(e.mensajeOffset=e.mensajes[e.mensajes.length-1],e.scrollToBottom())})).catch((function(t){401==t.response.status&&e.$router.push(\"/login\")}))},getChatPage:function(t){this.mensajeOffset=this.mensajes[0],this.currentPage=t;var e=\"\";null!=t&&(e=\"?page=\"+t);var s=this;this.$axios.get(this.$localurl+\"/api/v1/messages/\"+this.$route.params.id+e).then((function(t){t.data.messages.data.reverse(),s.mensajes=t.data.messages.data.concat(s.mensajes),s.scrollToBottom()})).catch((function(t){401==t.response.status&&s.$router.push(\"/login\")}))},onScroll:function(){var t=this.$refs.chatScroll;t.scrollTop<.1*t.clientHeight&&this.currentPage<this.lastPage&&(this.offset=this.offset+this.limit,this.currentPage++,this.getChatPage(this.currentPage))},scrollToBottom:function(){var t=this;this.$nextTick((function(){document.getElementById(\"chatScroll\").scrollTop=document.getElementById(t.mensajeOffset.id).offsetTop}))},enviar:function(){this.scrollToBottom();var t=this.$refs.inputTexto.value;if(\"\"!=t){this.$refs.inputTexto.value=\"\";var e=new FormData;e.append(\"message\",t),e.append(\"receiver_id\",this.$route.params.user_dest_id);var s=this;this.$axios.post(this.$localurl+\"/api/v1/messages\",e).then((function(){s.getChat()})).catch((function(t){401==t.response.status&&s.$router.push(\"/login\"),alert(\"Se produjo un error, reintente\")}))}},isOverflown:function(t){return t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth}}}),r=i,o=(s(\"6514\"),s(\"3bae\"),s(\"2877\")),c=Object(o[\"a\"])(r,a,n,!1,null,\"52ed952f\",null);e[\"default\"]=c.exports},\"3bae\":function(t,e,s){\"use strict\";var a=s(\"a339\"),n=s.n(a);n.a},6514:function(t,e,s){\"use strict\";var a=s(\"8e3c\"),n=s.n(a);n.a},\"8e3c\":function(t,e,s){},a339:function(t,e,s){}}]);","extractedComments":[]}